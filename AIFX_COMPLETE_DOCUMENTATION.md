# AIFX v2 å®Œæ•´ç³»çµ±æ–‡ä»¶
# AI-Powered Forex Trading Advisory System

---

## ç›®éŒ„

1. [å°ˆæ¡ˆæ¦‚è¿°](#1-å°ˆæ¡ˆæ¦‚è¿°)
2. [ç³»çµ±æ¶æ§‹](#2-ç³»çµ±æ¶æ§‹)
3. [æŠ€è¡“æ£§](#3-æŠ€è¡“æ£§)
4. [å¾®æœå‹™æ¶æ§‹](#4-å¾®æœå‹™æ¶æ§‹)
5. [Backend API æœå‹™](#5-backend-api-æœå‹™)
6. [ML Engine æ©Ÿå™¨å­¸ç¿’å¼•æ“](#6-ml-engine-æ©Ÿå™¨å­¸ç¿’å¼•æ“)
7. [Discord Bot](#7-discord-bot)
8. [LINE Bot](#8-line-bot)
9. [è³‡æ–™åº«è¨­è¨ˆ](#9-è³‡æ–™åº«è¨­è¨ˆ)
10. [è¨‚é–±é€šçŸ¥ç³»çµ±](#10-è¨‚é–±é€šçŸ¥ç³»çµ±)
11. [äº¤æ˜“é€±æœŸè¨­è¨ˆ](#11-äº¤æ˜“é€±æœŸè¨­è¨ˆ)
12. [API ç«¯é»å®Œæ•´åˆ—è¡¨](#12-api-ç«¯é»å®Œæ•´åˆ—è¡¨)
13. [èªè­‰èˆ‡å®‰å…¨æ©Ÿåˆ¶](#13-èªè­‰èˆ‡å®‰å…¨æ©Ÿåˆ¶)
14. [æ•¸æ“šæµç¨‹åœ–](#14-æ•¸æ“šæµç¨‹åœ–)
15. [éƒ¨ç½²æŒ‡å—](#15-éƒ¨ç½²æŒ‡å—)
16. [ç’°å¢ƒè®Šæ•¸å®Œæ•´åˆ—è¡¨](#16-ç’°å¢ƒè®Šæ•¸å®Œæ•´åˆ—è¡¨)
17. [é–‹ç™¼æ­·ç¨‹](#17-é–‹ç™¼æ­·ç¨‹)
18. [å¸¸è¦‹å•é¡Œ](#18-å¸¸è¦‹å•é¡Œ)

---

## 1. å°ˆæ¡ˆæ¦‚è¿°

### 1.1 å°ˆæ¡ˆç°¡ä»‹

AIFX æ˜¯ä¸€å€‹åŸºæ–¼äººå·¥æ™ºæ…§çš„å¤–åŒ¯äº¤æ˜“é¡§å•ç³»çµ±ï¼Œæ—¨åœ¨å”åŠ©äº¤æ˜“è€…åšå‡ºæ›´æ˜æ™ºçš„æŠ•è³‡æ±ºç­–ã€‚ç³»çµ±æ ¸å¿ƒæ¡ç”¨ LSTMï¼ˆé•·çŸ­æœŸè¨˜æ†¶ç¶²çµ¡ï¼‰æ·±åº¦å­¸ç¿’æ¨¡å‹ï¼Œåˆ†æåŒ…å«é–‹ç›¤åƒ¹ã€æ”¶ç›¤åƒ¹ã€æœ€é«˜åƒ¹ã€æœ€ä½åƒ¹ã€æˆäº¤é‡ç­‰ 12 é …æŠ€è¡“ç‰¹å¾µçš„æ­·å²æ•¸æ“šï¼Œé æ¸¬æœªä¾†åƒ¹æ ¼èµ°å‹¢ã€‚åŒæ™‚æ•´åˆ FinBERT é‡‘èé ˜åŸŸè‡ªç„¶èªè¨€è™•ç†æ¨¡å‹èˆ‡ VADER æƒ…ç·’åˆ†æå™¨ï¼Œå³æ™‚çˆ¬å–ä¸¦åˆ†æè²¡ç¶“æ–°èã€å¤®è¡Œæ”¿ç­–è²æ˜ç­‰å¸‚å ´è³‡è¨Šï¼Œé‡åŒ–å¸‚å ´æƒ…ç·’æŒ‡æ¨™ã€‚ç³»çµ±å°‡åƒ¹æ ¼é æ¸¬èˆ‡æƒ…ç·’åˆ†æçµæœé€²è¡ŒåŠ æ¬Šèåˆï¼Œä¾æ“šä¸åŒäº¤æ˜“é€±æœŸï¼ˆæ—¥å…§äº¤æ˜“ 15 åˆ†é˜ã€å‘¨å…§äº¤æ˜“ 1 å°æ™‚ã€æœˆå…§äº¤æ˜“ 1 å¤©ã€å­£å…§äº¤æ˜“ 1 é€±ï¼‰å‹•æ…‹èª¿æ•´æŠ€è¡“é¢èˆ‡æƒ…ç·’é¢çš„æ¬Šé‡æ¯”ä¾‹ï¼Œæœ€çµ‚ç”Ÿæˆè²·å…¥ï¼ˆBUYï¼‰ã€è³£å‡ºï¼ˆSELLï¼‰æˆ–æŒæœ‰ï¼ˆHOLDï¼‰çš„äº¤æ˜“è¨Šè™Ÿï¼Œä¸¦é™„å¸¶ä¿¡å¿ƒæŒ‡æ•¸ä¾›ç”¨æˆ¶åƒè€ƒã€‚ç”¨æˆ¶å¯é€é Discord Bot æˆ– LINE Bot è¨‚é–±æ„Ÿèˆˆè¶£çš„è²¨å¹£å°ï¼Œç•¶è¨Šè™Ÿç™¼ç”Ÿè®ŠåŒ–æ™‚ç³»çµ±æœƒå³æ™‚æ¨æ’­é€šçŸ¥ã€‚

### 1.2 æ ¸å¿ƒåŠŸèƒ½

| åŠŸèƒ½ | èªªæ˜ |
|------|------|
| **AI åƒ¹æ ¼é æ¸¬** | ä½¿ç”¨ LSTM æ·±åº¦å­¸ç¿’æ¨¡å‹åˆ†ææ­·å² OHLCV æ•¸æ“šï¼Œé æ¸¬åƒ¹æ ¼èµ°å‹¢ |
| **æƒ…ç·’åˆ†æ** | æ•´åˆ FinBERT + VADER åˆ†æè²¡ç¶“æ–°èèˆ‡å¤®è¡Œæ”¿ç­–ç«‹å ´ |
| **å¤šé€±æœŸè¨Šè™Ÿ** | æ”¯æ´æ—¥å…§(15min)ã€å‘¨å…§(1h)ã€æœˆå…§(1d)ã€å­£å…§(1w) å››ç¨®äº¤æ˜“é€±æœŸ |
| **å³æ™‚é€šçŸ¥** | é€é Discord Bot å’Œ LINE Bot æ¨é€è¨‚é–±çš„è¨Šè™Ÿè®ŠåŒ– |
| **è¨‚é–±ç®¡ç†** | ç”¨æˆ¶å¯è‡ªç”±è¨‚é–±/å–æ¶ˆè¨‚é–±ç‰¹å®šè²¨å¹£å°çš„ä¿¡è™Ÿé€šçŸ¥ |
| **å›æ¸¬ç³»çµ±** | ä½¿ç”¨æ­·å²æ•¸æ“šé©—è­‰äº¤æ˜“ç­–ç•¥çš„ç¸¾æ•ˆ |
| **æ•¸æ“šæ”¶é›†** | è‡ªå‹•æ”¶é›†å¸‚å ´æ•¸æ“šï¼Œæ··åˆæ¨¡å¼ç¯€çœ API é…é¡ |
| **ç®¡ç†å¾Œå°** | Python æ¡Œé¢æ‡‰ç”¨ç¨‹å¼ç›£æ§ç³»çµ±ç‹€æ…‹ |

### 1.3 æ”¯æ´è²¨å¹£å°

- **EUR/USD** (æ­å…ƒ/ç¾å…ƒ)
- **USD/JPY** (ç¾å…ƒ/æ—¥åœ“)
- **GBP/USD** (è‹±éŠ/ç¾å…ƒ)

### 1.4 ç›®éŒ„çµæ§‹

```
AIFX_v2/
â”œâ”€â”€ backend/                 # Node.js API æœå‹™ (Port 3000)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ app.js          # Express æ‡‰ç”¨ç¨‹å¼
â”‚   â”‚   â”œâ”€â”€ server.js       # ä¼ºæœå™¨å…¥å£
â”‚   â”‚   â”œâ”€â”€ config/         # é…ç½®æª”æ¡ˆ
â”‚   â”‚   â”œâ”€â”€ controllers/    # API æ§åˆ¶å™¨
â”‚   â”‚   â”œâ”€â”€ services/       # æ¥­å‹™é‚è¼¯æœå‹™
â”‚   â”‚   â”œâ”€â”€ models/         # Sequelize ORM æ¨¡å‹
â”‚   â”‚   â”œâ”€â”€ routes/         # API è·¯ç”±å®šç¾©
â”‚   â”‚   â”œâ”€â”€ middleware/     # Express ä¸­é–“ä»¶
â”‚   â”‚   â””â”€â”€ utils/          # å·¥å…·å‡½å¼
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ ml_engine/               # Python ML å¼•æ“ (Port 8000)
â”‚   â”œâ”€â”€ api/                # FastAPI æœå‹™
â”‚   â”‚   â”œâ”€â”€ ml_server.py    # ä¸»ç¨‹å¼å…¥å£
â”‚   â”‚   â”œâ”€â”€ reversal_api.py # åè½‰é æ¸¬ API
â”‚   â”‚   â”œâ”€â”€ model_manager.py# æ¨¡å‹ç®¡ç†å™¨
â”‚   â”‚   â””â”€â”€ ab_testing.py   # A/B æ¸¬è©¦æ¡†æ¶
â”‚   â”œâ”€â”€ services/           # æ ¸å¿ƒæœå‹™
â”‚   â”‚   â””â”€â”€ sentiment_analyzer.py  # æƒ…ç·’åˆ†ææœå‹™
â”‚   â”œâ”€â”€ models/             # ML æ¨¡å‹å®šç¾©
â”‚   â”‚   â”œâ”€â”€ price_predictor.py     # LSTM åƒ¹æ ¼é æ¸¬å™¨
â”‚   â”‚   â””â”€â”€ dual_mode_reversal_predictor.py
â”‚   â”œâ”€â”€ data_processing/    # æ•¸æ“šè™•ç†
â”‚   â”‚   â”œâ”€â”€ preprocessor.py        # æ•¸æ“šé è™•ç†å™¨
â”‚   â”‚   â””â”€â”€ twelvedata_fetcher.py  # Twelve Data API
â”‚   â”œâ”€â”€ backtest/           # å›æ¸¬ç³»çµ±
â”‚   â”œâ”€â”€ training/           # æ¨¡å‹è¨“ç·´è…³æœ¬
â”‚   â”œâ”€â”€ scripts/            # åŸ·è¡Œè…³æœ¬
â”‚   â”œâ”€â”€ saved_models/       # è¨“ç·´å¥½çš„æ¨¡å‹æ¬Šé‡
â”‚   â”œâ”€â”€ config.yaml         # é…ç½®æª”
â”‚   â””â”€â”€ requirements.txt    # Python ä¾è³´
â”‚
â”œâ”€â”€ discord_bot/             # Discord Bot
â”‚   â”œâ”€â”€ bot.js              # ä¸»ç¨‹å¼å…¥å£
â”‚   â”œâ”€â”€ deploy-commands.js  # éƒ¨ç½²æ–œç·šå‘½ä»¤
â”‚   â”œâ”€â”€ commands/           # æ–œç·šå‘½ä»¤
â”‚   â”‚   â”œâ”€â”€ signal.js       # æŸ¥è©¢äº¤æ˜“è¨Šè™Ÿ
â”‚   â”‚   â”œâ”€â”€ subscribe.js    # è¨‚é–±é€šçŸ¥
â”‚   â”‚   â”œâ”€â”€ unsubscribe.js  # å–æ¶ˆè¨‚é–±
â”‚   â”‚   â”œâ”€â”€ subscriptions.js# æŸ¥çœ‹è¨‚é–±åˆ—è¡¨
â”‚   â”‚   â”œâ”€â”€ position.js     # æŒå€‰å»ºè­°
â”‚   â”‚   â”œâ”€â”€ preferences.js  # äº¤æ˜“åå¥½è¨­å®š
â”‚   â”‚   â”œâ”€â”€ trading-guide.js# äº¤æ˜“æŒ‡å—
â”‚   â”‚   â””â”€â”€ ping.js         # é€£ç·šæ¸¬è©¦
â”‚   â”œâ”€â”€ services/           # æœå‹™å±¤
â”‚   â”‚   â””â”€â”€ backendClient.js# Backend API å®¢æˆ¶ç«¯
â”‚   â””â”€â”€ utils/              # å·¥å…·å‡½å¼
â”‚
â”œâ”€â”€ line_bot/                # LINE Bot (Port 3001)
â”‚   â”œâ”€â”€ bot.js              # Express webhook ä¼ºæœå™¨
â”‚   â”œâ”€â”€ handlers/           # è¨Šæ¯è™•ç†å™¨
â”‚   â”‚   â””â”€â”€ messageHandler.js
â”‚   â”œâ”€â”€ services/           # æœå‹™å±¤
â”‚   â”‚   â”œâ”€â”€ backendClient.js   # Backend API å®¢æˆ¶ç«¯
â”‚   â”‚   â””â”€â”€ messageBuilder.js  # Flex Message å»ºæ§‹å™¨
â”‚   â””â”€â”€ utils/              # å·¥å…·å‡½å¼
â”‚
â”œâ”€â”€ admin_app/               # Python ç®¡ç†å¾Œå° (Tkinter)
â”‚   â””â”€â”€ aifx_admin_v2.py    # æ¡Œé¢æ‡‰ç”¨ç¨‹å¼
â”‚
â”œâ”€â”€ frontend/                # React å‰ç«¯ (é–‹ç™¼ä¸­)
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/     # React çµ„ä»¶
â”‚   â”‚   â”œâ”€â”€ pages/          # é é¢
â”‚   â”‚   â”œâ”€â”€ services/       # API æœå‹™
â”‚   â”‚   â””â”€â”€ App.jsx         # ä¸»ç¨‹å¼
â”‚   â””â”€â”€ vite.config.js
â”‚
â”œâ”€â”€ database/                # è³‡æ–™åº«ç›¸é—œ
â”‚   â”œâ”€â”€ migrations/         # Sequelize é·ç§»æª”
â”‚   â””â”€â”€ seeders/            # ç¨®å­è³‡æ–™
â”‚
â”œâ”€â”€ docs/                    # API æ–‡ä»¶
â”œâ”€â”€ scripts/                 # å·¥å…·è…³æœ¬
â”œâ”€â”€ tests/                   # æ¸¬è©¦æª”æ¡ˆ
â”œâ”€â”€ logs/                    # æ—¥èªŒæª”æ¡ˆ
â”‚
â”œâ”€â”€ start-all-services.sh    # ä¸€éµå•Ÿå‹•æ‰€æœ‰æœå‹™
â”œâ”€â”€ stop-all-services.sh     # ä¸€éµåœæ­¢æ‰€æœ‰æœå‹™
â”œâ”€â”€ check_services.sh        # æª¢æŸ¥æœå‹™ç‹€æ…‹
â”‚
â”œâ”€â”€ CLAUDE.md                # Claude Code é–‹ç™¼è¦ç¯„
â”œâ”€â”€ DEVELOPMENT_HISTORY.md   # é–‹ç™¼æ­·å²è¨˜éŒ„
â”œâ”€â”€ README.md                # å°ˆæ¡ˆèªªæ˜
â”œâ”€â”€ BOTS.md                  # Bot æœå‹™èªªæ˜
â”œâ”€â”€ ML_ENGINE.md             # ML å¼•æ“èªªæ˜
â””â”€â”€ SERVICES.md              # æœå‹™èªªæ˜
```

---

## 2. ç³»çµ±æ¶æ§‹

### 2.1 æ•´é«”æ¶æ§‹åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              ç”¨æˆ¶ç«¯ (Client)                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚        Discord App            â”‚              LINE App                        â”‚
â”‚    (iOS/Android/Desktop)      â”‚         (iOS/Android)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                                   â”‚
                â”‚ Discord Gateway                   â”‚ HTTPS Webhook
                â”‚ (WebSocket)                       â”‚
                â–¼                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Discord Bot             â”‚     â”‚           LINE Bot                     â”‚
â”‚       (Node.js)               â”‚     â”‚     (Node.js + Express)               â”‚
â”‚                               â”‚     â”‚         Port: 3001                     â”‚
â”‚  â€¢ Slash Commands             â”‚     â”‚  â€¢ Text Message Handler               â”‚
â”‚  â€¢ Embed Messages             â”‚     â”‚  â€¢ Flex Message Builder               â”‚
â”‚  â€¢ Redis Pub/Sub              â”‚     â”‚  â€¢ Redis Pub/Sub                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                                         â”‚
                â”‚ REST API (X-API-Key)                   â”‚ REST API (Bearer Token)
                â”‚                                         â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Backend API Server                                  â”‚
â”‚                      (Node.js + Express, Port: 3000)                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚   Routes     â”‚â”€â”€â–¶â”‚ Controllers  â”‚â”€â”€â–¶â”‚   Services   â”‚â”€â”€â–¶â”‚   Models   â”‚  â”‚
â”‚   â”‚   è·¯ç”±å±¤     â”‚   â”‚   æ§åˆ¶å™¨å±¤   â”‚   â”‚   æœå‹™å±¤     â”‚   â”‚   æ¨¡å‹å±¤   â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                 â”‚                  â”‚        â”‚
â”‚   ä¸»è¦æœå‹™:                                     â”‚                  â”‚        â”‚
â”‚   â€¢ forexService (å¸‚å ´æ•¸æ“š)                     â”‚                  â”‚        â”‚
â”‚   â€¢ tradingSignalService (ä¿¡è™Ÿç”Ÿæˆ)            â”‚                  â”‚        â”‚
â”‚   â€¢ signalMonitoringService (ä¿¡è™Ÿç›£æ§)         â”‚                  â”‚        â”‚
â”‚   â€¢ mlEngineService (ML æ•´åˆ)                  â”‚                  â”‚        â”‚
â”‚                                                 â”‚                  â”‚        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                  â”‚                  â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                                       â”‚                  â”‚       â”‚
          â–¼                                       â–¼                  â–¼       â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   ML Engine     â”‚                    â”‚   PostgreSQL    â”‚  â”‚    Redis     â”‚ â”‚
â”‚   (FastAPI)     â”‚                    â”‚   Database      â”‚  â”‚    Cache     â”‚ â”‚
â”‚   Port: 8000    â”‚                    â”‚   Port: 5432    â”‚  â”‚  Port: 6379  â”‚ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚
â”‚ â€¢ LSTM Model    â”‚                    â”‚ â€¢ users         â”‚  â”‚ â€¢ å¸‚å ´æ•¸æ“š   â”‚ â”‚
â”‚ â€¢ FinBERT       â”‚                    â”‚ â€¢ market_data   â”‚  â”‚ â€¢ ä¿¡è™Ÿå¿«å–   â”‚ â”‚
â”‚ â€¢ VADER         â”‚                    â”‚ â€¢ signals       â”‚  â”‚ â€¢ Session    â”‚ â”‚
â”‚ â€¢ Reversal API  â”‚                    â”‚ â€¢ subscriptions â”‚  â”‚ â€¢ Pub/Sub    â”‚ â”‚
â”‚ â€¢ A/B Testing   â”‚                    â”‚ â€¢ ...           â”‚  â”‚              â”‚ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
                                                                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â”‚   å¤–éƒ¨æ•¸æ“šæº (æ··åˆæ¨¡å¼):
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   â”‚         å¸‚å ´æ•¸æ“š (æ··åˆ)          â”‚    â”‚         æ–°èæƒ…ç·’ (æ··åˆ)          â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚  â”‚ Twelve  â”‚    â”‚ yfinanceâ”‚    â”‚    â”‚  â”‚ NewsAPI â”‚    â”‚ Google  â”‚    â”‚
â”‚   â”‚  â”‚  Data   â”‚ +  â”‚ (å‚™ç”¨)  â”‚    â”‚    â”‚  â”‚         â”‚ +  â”‚  News   â”‚    â”‚
â”‚   â”‚  â”‚  API    â”‚    â”‚         â”‚    â”‚    â”‚  â”‚         â”‚    â”‚  RSS    â”‚    â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
```

### 2.2 æœå‹™ç«¯å£é…ç½®

| æœå‹™ | ç«¯å£ | èªªæ˜ |
|------|------|------|
| Backend API | 3000 | æ ¸å¿ƒ REST API æœå‹™ |
| ML Engine | 8000 | Python FastAPI ML æœå‹™ |
| LINE Bot | 3001 | LINE Webhook ä¼ºæœå™¨ |
| PostgreSQL | 5432 | é—œè¯å¼è³‡æ–™åº« |
| Redis | 6379 | å¿«å–èˆ‡ Pub/Sub |
| Frontend (Dev) | 5173 | React é–‹ç™¼ä¼ºæœå™¨ |

---

## 3. æŠ€è¡“æ£§

### 3.1 å¾Œç«¯ (Backend)

| æŠ€è¡“ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Node.js | â‰¥ 18.0.0 | JavaScript åŸ·è¡Œç’°å¢ƒ |
| Express.js | ^4.18.0 | Web æ¡†æ¶ |
| Sequelize | ^6.0.0 | ORM (PostgreSQL) |
| jsonwebtoken | ^9.0.0 | JWT èªè­‰ |
| bcrypt | ^5.0.0 | å¯†ç¢¼é›œæ¹Š |
| axios | ^1.0.0 | HTTP å®¢æˆ¶ç«¯ |
| socket.io | ^4.0.0 | WebSocket |
| redis | ^4.0.0 | Redis å®¢æˆ¶ç«¯ |
| winston | ^3.0.0 | æ—¥èªŒè¨˜éŒ„ |
| joi | ^17.0.0 | æ•¸æ“šé©—è­‰ |
| helmet | ^7.0.0 | å®‰å…¨æ¨™é ­ |
| cors | ^2.8.0 | CORS è™•ç† |

### 3.2 æ©Ÿå™¨å­¸ç¿’å¼•æ“ (ML Engine)

| æŠ€è¡“ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Python | â‰¥ 3.9 | ç¨‹å¼èªè¨€ |
| TensorFlow | â‰¥ 2.10.0 | æ·±åº¦å­¸ç¿’æ¡†æ¶ |
| scikit-learn | â‰¥ 1.0.0 | æ©Ÿå™¨å­¸ç¿’å·¥å…· |
| pandas | â‰¥ 1.5.0 | æ•¸æ“šè™•ç† |
| numpy | â‰¥ 1.23.0 | æ•¸å€¼é‹ç®— |
| FastAPI | â‰¥ 0.100.0 | Web API æ¡†æ¶ |
| uvicorn | â‰¥ 0.23.0 | ASGI ä¼ºæœå™¨ |
| transformers | latest | FinBERT æ¨¡å‹ |
| vaderSentiment | latest | VADER æƒ…ç·’åˆ†æ |

### 3.3 å‰ç«¯ (Frontend)

| æŠ€è¡“ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| React | ^18.2.0 | UI æ¡†æ¶ |
| Vite | ^4.0.0 | å»ºç½®å·¥å…· |
| Tailwind CSS | ^3.0.0 | CSS æ¡†æ¶ |
| Chart.js | ^4.0.0 | åœ–è¡¨ç¹ªè£½ |
| socket.io-client | ^4.0.0 | WebSocket å®¢æˆ¶ç«¯ |
| axios | ^1.0.0 | HTTP å®¢æˆ¶ç«¯ |

### 3.4 Bot æœå‹™

| æŠ€è¡“ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| Discord.js | ^14.0.0 | Discord Bot SDK |
| @line/bot-sdk | ^8.0.0 | LINE Bot SDK |

### 3.5 è³‡æ–™åº«èˆ‡å¿«å–

| æŠ€è¡“ | ç‰ˆæœ¬ | ç”¨é€” |
|------|------|------|
| PostgreSQL | â‰¥ 14.0 | ä¸»è³‡æ–™åº« |
| Redis | â‰¥ 6.0 | å¿«å–/Pub/Sub |

---

## 4. å¾®æœå‹™æ¶æ§‹

### 4.1 æ ¸å¿ƒåŸå‰‡

AIFX v2 éµå¾ªå¾®æœå‹™æ¶æ§‹ï¼Œç¢ºä¿å„æœå‹™ç¨ç«‹é‹ä½œï¼š

#### 1ï¸âƒ£ æœå‹™ç¨ç«‹æ€§

```
âœ… æ¯å€‹æœå‹™å¯ä»¥ç¨ç«‹å•Ÿå‹•/åœæ­¢
âœ… æœå‹™æ•…éšœä¸æœƒé€£é–å½±éŸ¿å…¶ä»–æœå‹™
âœ… æ¯å€‹æœå‹™æœ‰ç¨ç«‹çš„å¥åº·æª¢æŸ¥ç«¯é»
âŒ æœå‹™é–“ä¸å…±äº«è³‡æ–™åº«æ¨¡å‹
âŒ é™¤ Backend å¤–ï¼Œå…¶ä»–æœå‹™ä¸ç›´æ¥å­˜å–è³‡æ–™åº«
```

#### 2ï¸âƒ£ å–®ä¸€è³‡æ–™åº«æ“æœ‰è€…

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   è³‡æ–™åº«å­˜å–ç­–ç•¥                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚   Frontend          â”€â”€â”                                      â”‚
â”‚                       â”‚                                      â”‚
â”‚   Discord Bot       â”€â”€â”¼â”€â”€â”€â”€ REST API â”€â”€â”€â”€â–º Backend â”€â”€â–º PostgreSQL
â”‚                       â”‚                      (å”¯ä¸€)          â”‚
â”‚   LINE Bot          â”€â”€â”¼                                      â”‚
â”‚                       â”‚                                      â”‚
â”‚   ML Engine         â”€â”€â”˜                                      â”‚
â”‚                                                              â”‚
â”‚   âœ… åªæœ‰ Backend å¯ç›´æ¥å­˜å– PostgreSQL                      â”‚
â”‚   âœ… å…¶ä»–æœå‹™å¿…é ˆé€é Backend REST API                       â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3ï¸âƒ£ API é€šè¨Šè¦å‰‡

```
æœå‹™é–“é€šè¨Šæ¶æ§‹:

Frontend â”€â”€â”€ JWT Token â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                  â”‚
Discord Bot â”€ X-API-Key â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â–º Backend â”€â”€â”€â–º PostgreSQL
                                  â”‚        â”‚
LINE Bot â”€â”€â”€ Bearer Token â”€â”€â”€â”€â”€â”€â”€â”˜        â”œâ”€â”€â”€â–º Redis
                                           â”‚
Admin App â”€â”€â”€ Admin JWT â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚
                                           â”‚
                                           â””â”€â”€â”€â–º ML Engine
```

### 4.2 æœå‹™è²¬ä»»çŸ©é™£

| è²¬ä»» | Backend | ML Engine | Discord Bot | LINE Bot | Frontend |
|------|---------|-----------|-------------|----------|----------|
| è³‡æ–™åº«å­˜å– | âœ… å”¯ä¸€ | âŒ API | âŒ API | âŒ API | âŒ API |
| ç”¨æˆ¶èªè­‰ | âœ… | âŒ | âŒ | âŒ | âœ… Client |
| ML è¨“ç·´ | âŒ | âœ… å”¯ä¸€ | âŒ | âŒ | âŒ |
| Discord è¨Šæ¯ | âŒ | âŒ | âœ… å”¯ä¸€ | âŒ | âŒ |
| LINE è¨Šæ¯ | âŒ | âŒ | âŒ | âœ… å”¯ä¸€ | âŒ |
| WebSocket | âœ… Server | âŒ | âŒ | âŒ | âœ… Client |
| ä¿¡è™Ÿç”Ÿæˆ | âœ… | âœ… é æ¸¬ | âŒ | âŒ | âŒ |

### 4.3 å¥åº·æª¢æŸ¥ç«¯é»

æ¯å€‹æœå‹™éƒ½å¿…é ˆå¯¦ä½œå¥åº·æª¢æŸ¥ï¼š

```javascript
// å›æ‡‰æ ¼å¼
GET /health

{
  "status": "healthy",
  "service": "backend",
  "version": "1.0.0",
  "uptime": 3600,
  "dependencies": {
    "postgres": "connected",
    "redis": "connected",
    "ml_engine": "connected"
  }
}
```

---

## 5. Backend API æœå‹™

### 5.1 æ¶æ§‹æ¦‚è¿°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Backend API (Port 3000)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   Request â”€â”€â–º Middleware â”€â”€â–º Routes â”€â”€â–º Controllers â”€â”€â–º Services        â”‚
â”‚                  â”‚                                          â”‚            â”‚
â”‚                  â”‚                                          â–¼            â”‚
â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”                            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚           â”‚ â€¢ auth.js   â”‚                            â”‚    Models    â”‚   â”‚
â”‚           â”‚ â€¢ cors      â”‚                            â”‚  (Sequelize) â”‚   â”‚
â”‚           â”‚ â€¢ rateLimit â”‚                            â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚           â”‚ â€¢ helmet    â”‚                                   â”‚           â”‚
â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                   â–¼           â”‚
â”‚                                                       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚                                                       â”‚  PostgreSQL  â”‚   â”‚
â”‚                                                       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 ç›®éŒ„çµæ§‹

```
backend/src/
â”œâ”€â”€ app.js                    # Express æ‡‰ç”¨ç¨‹å¼é…ç½®
â”œâ”€â”€ server.js                 # ä¼ºæœå™¨å…¥å£é»
â”œâ”€â”€ config/
â”‚   â”œâ”€â”€ database.js           # PostgreSQL é…ç½®
â”‚   â””â”€â”€ redis.js              # Redis é…ç½®
â”œâ”€â”€ controllers/
â”‚   â”œâ”€â”€ adminController.js    # ç®¡ç†å“¡æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ authController.js     # èªè­‰æ§åˆ¶å™¨
â”‚   â”œâ”€â”€ tradingController.js  # äº¤æ˜“è¨Šè™Ÿæ§åˆ¶å™¨
â”‚   â”œâ”€â”€ marketController.js   # å¸‚å ´æ•¸æ“šæ§åˆ¶å™¨
â”‚   â””â”€â”€ subscriptionsController.js  # è¨‚é–±æ§åˆ¶å™¨
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ forexService.js       # å¤–åŒ¯æ•¸æ“šæœå‹™
â”‚   â”œâ”€â”€ tradingSignalService.js    # è¨Šè™Ÿç”Ÿæˆæœå‹™
â”‚   â”œâ”€â”€ signalMonitoringService.js # ä¿¡è™Ÿç›£æ§æœå‹™
â”‚   â”œâ”€â”€ mlEngineService.js    # ML Engine æ•´åˆæœå‹™
â”‚   â””â”€â”€ technicalAnalysis.js  # æŠ€è¡“æŒ‡æ¨™è¨ˆç®—
â”œâ”€â”€ models/
â”‚   â”œâ”€â”€ index.js              # æ¨¡å‹é—œè¯å®šç¾©
â”‚   â”œâ”€â”€ User.js               # ç”¨æˆ¶æ¨¡å‹
â”‚   â”œâ”€â”€ UserDiscordSettings.js
â”‚   â”œâ”€â”€ UserLineSettings.js
â”‚   â”œâ”€â”€ TradingSignal.js
â”‚   â”œâ”€â”€ MarketData.js
â”‚   â”œâ”€â”€ UserSubscription.js
â”‚   â””â”€â”€ ...
â”œâ”€â”€ routes/
â”‚   â”œâ”€â”€ auth.js               # èªè­‰è·¯ç”±
â”‚   â”œâ”€â”€ trading.js            # äº¤æ˜“è·¯ç”±
â”‚   â”œâ”€â”€ market.js             # å¸‚å ´æ•¸æ“šè·¯ç”±
â”‚   â”œâ”€â”€ notifications.js      # é€šçŸ¥è·¯ç”±
â”‚   â”œâ”€â”€ admin.js              # ç®¡ç†å“¡è·¯ç”±
â”‚   â””â”€â”€ api/v1/
â”‚       â”œâ”€â”€ discord/          # Discord Bot API
â”‚       â”œâ”€â”€ line/             # LINE Bot API
â”‚       â”œâ”€â”€ ml/               # ML ç›¸é—œ API
â”‚       â””â”€â”€ subscriptions.js  # è¨‚é–± API
â”œâ”€â”€ middleware/
â”‚   â”œâ”€â”€ auth.js               # JWT èªè­‰ä¸­é–“ä»¶
â”‚   â””â”€â”€ adminAuth.js          # ç®¡ç†å“¡èªè­‰ä¸­é–“ä»¶
â””â”€â”€ utils/
    â”œâ”€â”€ periodMapper.js       # äº¤æ˜“é€±æœŸæ˜ å°„
    â””â”€â”€ logger.js             # æ—¥èªŒå·¥å…·
```

### 5.3 æ ¸å¿ƒæœå‹™è©³è§£

#### forexService.js - å¸‚å ´æ•¸æ“šæœå‹™

```javascript
/**
 * åŠŸèƒ½:
 * - ç²å–å³æ™‚/æ­·å²å¸‚å ´æ•¸æ“š
 * - æ··åˆæ¨¡å¼æ•¸æ“šä¾†æº: Twelve Data API + yfinance (å‚™ç”¨)
 * - Redis å¿«å–ç®¡ç† (TTL: 60 ç§’)
 * - æ··åˆæ¨¡å¼: è³‡æ–™åº« 99 æ ¹ + API 1 æ ¹æœ€æ–°
 *
 * æ•¸æ“šæºç­–ç•¥:
 * - ä¸»è¦: Twelve Data API (800 æ¬¡/æ—¥)
 * - å‚™ç”¨: yfinance (ç„¡é™åˆ¶ï¼Œå…è²»)
 * - è‡ªå‹•æ•…éšœè½‰ç§»ç¢ºä¿é«˜å¯ç”¨æ€§
 *
 * ä¸»è¦æ–¹æ³•:
 * - getMarketData(pair, timeframe)
 * - getHistoricalData(pair, timeframe, limit)
 * - cacheData(key, data, ttl)
 */
```

#### tradingSignalService.js - è¨Šè™Ÿç”Ÿæˆæœå‹™

```javascript
/**
 * åŠŸèƒ½:
 * - ç”Ÿæˆäº¤æ˜“è¨Šè™Ÿ (BUY/SELL/HOLD)
 * - æ•´åˆ ML Engine é æ¸¬
 * - è¨ˆç®—æŠ€è¡“æŒ‡æ¨™ (SMA, RSI, MACD)
 * - èåˆæŠ€è¡“åˆ†æèˆ‡æƒ…ç·’åˆ†æ
 *
 * ä¸»è¦æ–¹æ³•:
 * - generateSignal(pair, timeframe)
 * - calculateIndicators(data)
 * - fuseSignals(technical, sentiment, timeframe)
 */
```

#### signalMonitoringService.js - ä¿¡è™Ÿç›£æ§æœå‹™

```javascript
/**
 * åŠŸèƒ½:
 * - å®šæ™‚ç›£æ§ä¿¡è™Ÿè®ŠåŒ– (æ¯ 15 åˆ†é˜)
 * - æ¯”å°æ–°èˆŠä¿¡è™Ÿç‹€æ…‹
 * - ç™¼å¸ƒ Redis Pub/Sub äº‹ä»¶
 * - é€šçŸ¥è¨‚é–±ç”¨æˆ¶
 *
 * ä¸»è¦æ–¹æ³•:
 * - startMonitoring()
 * - checkSignalChanges()
 * - notifySubscribers(event)
 */
```

### 5.4 API å›æ‡‰æ ¼å¼

æ‰€æœ‰ API éµå¾ªçµ±ä¸€å›æ‡‰æ ¼å¼ï¼š

```javascript
// æˆåŠŸå›æ‡‰
{
  "success": true,
  "data": {
    // å¯¦éš›æ•¸æ“š
  },
  "error": null,
  "timestamp": "2025-12-02T10:30:00Z"
}

// éŒ¯èª¤å›æ‡‰
{
  "success": false,
  "data": null,
  "error": {
    "code": "INVALID_PAIR",
    "message": "Invalid currency pair format"
  },
  "timestamp": "2025-12-02T10:30:00Z"
}
```

---

## 6. ML Engine æ©Ÿå™¨å­¸ç¿’å¼•æ“

### 6.1 æ¶æ§‹æ¦‚è¿°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ML Engine (Port 8000)                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                      FastAPI Application                         â”‚   â”‚
â”‚   â”‚                                                                  â”‚   â”‚
â”‚   â”‚   /health        â†’ å¥åº·æª¢æŸ¥                                      â”‚   â”‚
â”‚   â”‚   /predict       â†’ LSTM åƒ¹æ ¼é æ¸¬                                 â”‚   â”‚
â”‚   â”‚   /train         â†’ æ¨¡å‹è¨“ç·´                                      â”‚   â”‚
â”‚   â”‚   /sentiment/*   â†’ æƒ…ç·’åˆ†æ                                      â”‚   â”‚
â”‚   â”‚   /reversal/*    â†’ åè½‰é æ¸¬                                      â”‚   â”‚
â”‚   â”‚   /model/info    â†’ æ¨¡å‹è³‡è¨Š                                      â”‚   â”‚
â”‚   â”‚   /market-data/* â†’ å¸‚å ´æ•¸æ“š                                      â”‚   â”‚
â”‚   â”‚                                                                  â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                          â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚   â”‚  Price         â”‚  â”‚   Sentiment     â”‚  â”‚   Reversal      â”‚        â”‚
â”‚   â”‚  Predictor     â”‚  â”‚   Analyzer      â”‚  â”‚   Predictor     â”‚        â”‚
â”‚   â”‚  (LSTM)        â”‚  â”‚  (FinBERT)      â”‚  â”‚  (2-Stage)      â”‚        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚            â”‚                    â”‚                    â”‚                  â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                 â”‚                                       â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â”‚
â”‚                    â”‚    Signal Fusion        â”‚                         â”‚
â”‚                    â”‚   (åŠ æ¬Šèåˆæ±ºç­–)        â”‚                         â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.2 LSTM åƒ¹æ ¼é æ¸¬æ¨¡å‹

#### æ¨¡å‹æ¶æ§‹

```
è¼¸å…¥å±¤ (60 æ™‚é–“æ­¥ Ã— 12 ç‰¹å¾µ)
         â”‚
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     LSTM Layer 1            â”‚
â”‚     (128 units)             â”‚
â”‚     return_sequences=True   â”‚
â”‚     dropout=0.2             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     LSTM Layer 2            â”‚
â”‚     (64 units)              â”‚
â”‚     return_sequences=False  â”‚
â”‚     dropout=0.2             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Dropout (0.2)           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     Dense (32, ReLU)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Dense (3, Softmax)         â”‚
â”‚  [Long, Short, Standby]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### è¼¸å…¥ç‰¹å¾µ (12 ç¶­)

| # | ç‰¹å¾µ | èªªæ˜ | è¨ˆç®—æ–¹å¼ |
|---|------|------|----------|
| 1 | Open | é–‹ç›¤åƒ¹ | åŸå§‹æ•¸æ“š |
| 2 | High | æœ€é«˜åƒ¹ | åŸå§‹æ•¸æ“š |
| 3 | Low | æœ€ä½åƒ¹ | åŸå§‹æ•¸æ“š |
| 4 | Close | æ”¶ç›¤åƒ¹ | åŸå§‹æ•¸æ“š |
| 5 | Volume | æˆäº¤é‡ | åŸå§‹æ•¸æ“š |
| 6 | SMA_5 | 5 æœŸç°¡å–®ç§»å‹•å¹³å‡ | (Câ‚+Câ‚‚+...+Câ‚…)/5 |
| 7 | SMA_20 | 20 æœŸç°¡å–®ç§»å‹•å¹³å‡ | (Câ‚+Câ‚‚+...+Câ‚‚â‚€)/20 |
| 8 | EMA_12 | 12 æœŸæŒ‡æ•¸ç§»å‹•å¹³å‡ | åŠ æ¬Šç§»å‹•å¹³å‡ |
| 9 | RSI_14 | 14 æœŸç›¸å°å¼·å¼±æŒ‡æ¨™ | 100 - 100/(1+RS) |
| 10 | MACD | MACD ç·š | EMAâ‚â‚‚ - EMAâ‚‚â‚† |
| 11 | BB_Upper | å¸ƒæ—é€šé“ä¸Šè»Œ | SMAâ‚‚â‚€ + 2Ïƒ |
| 12 | BB_Lower | å¸ƒæ—é€šé“ä¸‹è»Œ | SMAâ‚‚â‚€ - 2Ïƒ |

#### è¨“ç·´åƒæ•¸

```python
optimizer = Adam(learning_rate=0.001)
loss = 'categorical_crossentropy'
batch_size = 32
epochs = 100
early_stopping = EarlyStopping(
    monitor='val_loss',
    patience=10,
    restore_best_weights=True
)
```

### 6.3 æƒ…ç·’åˆ†æç³»çµ±

#### åˆ†æä¾†æº

| ä¾†æº | æ¨¡å‹/æ–¹æ³• | èªªæ˜ |
|------|----------|------|
| æ–°èæƒ…ç·’ | FinBERT | é‡‘èå°ˆç”¨ BERT æ¨¡å‹ (ProsusAI/finbert) |
| å¤®è¡Œæ”¿ç­– | VADER + é—œéµå­— | è²¨å¹£æ”¿ç­–ç«‹å ´åˆ†æ |

#### æ–°èæ•¸æ“šæ··åˆä¾†æº

æœ¬ç³»çµ±æ¡ç”¨é›™æ–°èä¾†æºç¢ºä¿é«˜å¯ç”¨æ€§ï¼š

| æ•¸æ“šä¾†æº | å„ªé» | é™åˆ¶ | ç”¨é€” |
|----------|------|------|------|
| NewsAPI | åŠŸèƒ½å®Œæ•´ã€å¤šèªè¨€æ”¯æ´ | å…è²»ç‰ˆ 100 req/day | ä¸»è¦ä¾†æº |
| Google News RSS | å®Œå…¨å…è²»ã€ç„¡é™åˆ¶ | åƒ…æ¨™é¡Œã€è‹±æ–‡ç‚ºä¸» | å‚™ç”¨ä¾†æº |

```
æ–°èç²å–ç­–ç•¥:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  NewsAPI (ä¸»è¦)                       â”‚
â”‚  â””â”€â†’ è‹¥å¤±æ•—/é…é¡ç”¨ç›¡ â†’ Google News RSS â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### FinBERT æƒ…ç·’åˆ†ææµç¨‹

```python
# 1. è¼‰å…¥æ¨¡å‹
model = pipeline("sentiment-analysis", model="ProsusAI/finbert")

# 2. åˆ†ææ–°èæ¨™é¡Œèˆ‡å…§å®¹
result = model(text[:512])
# è¼¸å‡º: {'label': 'positive/negative/neutral', 'score': 0.0-1.0}

# 3. æ˜ å°„åˆ°æƒ…ç·’åˆ†æ•¸
score_map = {
    'positive': 0.8,  # çœ‹å¤š
    'negative': 0.2,  # çœ‹ç©º
    'neutral': 0.5    # ä¸­æ€§
}
```

#### å¤®è¡Œæ”¿ç­–åˆ†æ

| è²¨å¹£ | å¤®è¡Œ | åˆ†æé—œéµå­— |
|------|------|-----------|
| USD | Federal Reserve (Fed) | interest rate, FOMC, hawkish, dovish |
| EUR | European Central Bank (ECB) | rate decision, monetary policy |
| JPY | Bank of Japan (BOJ) | yield curve control, stimulus |
| GBP | Bank of England (BoE) | inflation report, rate decision |

#### æƒ…ç·’åˆ†æ•¸è¨ˆç®—

```python
# æ–°èæƒ…ç·’åˆ†æ•¸ (-1 åˆ° +1 â†’ 0 åˆ° 1)
news_sentiment = weighted_average(article_scores)

# å¤®è¡Œæƒ…ç·’åˆ†æ•¸
central_bank_sentiment = analyze_policy_stance(policy_text)

# è‡ªé©æ‡‰æ¬Šé‡ (æ ¹æ“šæ™‚é–“æ¡†æ¶)
weights = calculate_adaptive_weights(news, gov, timeframe)

# ç¶œåˆæƒ…ç·’åˆ†æ•¸
combined_sentiment = (news_sentiment * weights['news'] +
                      central_bank_sentiment * weights['gov'])
```

### 6.4 è¨Šè™Ÿèåˆæ©Ÿåˆ¶

#### æ™‚é–“æ¡†æ¶æ¬Šé‡

| æ™‚é–“æ¡†æ¶ | æŠ€è¡“æ¬Šé‡ | æƒ…ç·’æ¬Šé‡ | èªªæ˜ |
|----------|----------|----------|------|
| 15min | 95% | 5% | çŸ­ç·šä»¥æŠ€è¡“ç‚ºä¸» |
| 1h | 85% | 15% | æ³¢æ®µäº¤æ˜“ |
| 4h | 70% | 30% | ä¸­æœŸäº¤æ˜“ |
| 1d | 55% | 45% | æ—¥ç·šé‡è¦–åŸºæœ¬é¢ |
| 1w | 40% | 60% | é•·ç·šæƒ…ç·’ä¸»å° |

#### èåˆå…¬å¼

```python
# æŠ€è¡“åˆ†æ•¸ (LSTM è¼¸å‡º)
technical_score = lstm_prediction['confidence']

# æƒ…ç·’åˆ†æ•¸
sentiment_score = sentiment_analyzer.analyze(pair)['sentiment_score']

# å–å¾—æ¬Šé‡
tech_weight, sent_weight = get_weights(timeframe)

# æœ€çµ‚ä¿¡å¿ƒåº¦
final_confidence = (technical_score * tech_weight) + (sentiment_score * sent_weight)

# è¨Šè™Ÿå¼·åº¦åˆ¤å®š
if final_confidence > 0.75:
    strength = 'very_strong'
elif final_confidence > 0.65:
    strength = 'strong'
elif final_confidence > 0.55:
    strength = 'moderate'
else:
    strength = 'weak'
```

### 6.5 API ç«¯é»

| ç«¯é» | æ–¹æ³• | èªªæ˜ |
|------|------|------|
| `/health` | GET | å¥åº·æª¢æŸ¥ |
| `/predict` | POST | LSTM åƒ¹æ ¼é æ¸¬ |
| `/train` | POST | æ¨¡å‹è¨“ç·´ |
| `/model/info` | GET | æ¨¡å‹è³‡è¨Š |
| `/market-data/{pair}` | GET | ç²å–å¸‚å ´æ•¸æ“š |
| `/sentiment/analyze` | POST | æƒ…ç·’åˆ†æ |
| `/sentiment/health` | GET | æƒ…ç·’æœå‹™å¥åº·æª¢æŸ¥ |
| `/reversal/predict_raw` | POST | åè½‰é æ¸¬ (å«æƒ…ç·’) |

---

## 7. Discord Bot

### 7.1 åŠŸèƒ½æ¦‚è¿°

Discord Bot æä¾›æ–œç·šå‘½ä»¤ä»‹é¢ï¼Œè®“ç”¨æˆ¶é€é Discord æŸ¥è©¢äº¤æ˜“è¨Šè™Ÿèˆ‡ç®¡ç†è¨‚é–±ã€‚

### 7.2 æ–œç·šå‘½ä»¤åˆ—è¡¨

| å‘½ä»¤ | åƒæ•¸ | èªªæ˜ |
|------|------|------|
| `/signal` | `[è²¨å¹£å°]` `[é€±æœŸ]` | æŸ¥è©¢äº¤æ˜“è¨Šè™Ÿ |
| `/subscribe` | `[è²¨å¹£å°]` `[æ™‚é–“æ¡†æ¶]` | è¨‚é–±ä¿¡è™Ÿè®ŠåŒ–é€šçŸ¥ |
| `/unsubscribe` | `[è²¨å¹£å°]` `[æ™‚é–“æ¡†æ¶]` | å–æ¶ˆè¨‚é–± |
| `/subscriptions` | - | æŸ¥çœ‹æ‰€æœ‰è¨‚é–± |
| `/position` | `[è²¨å¹£å°]` | æŸ¥çœ‹æŒå€‰å»ºè­° |
| `/preferences` | - | è¨­å®šäº¤æ˜“åå¥½ |
| `/trading-guide` | - | é¡¯ç¤ºäº¤æ˜“æŒ‡å— |
| `/ping` | - | æ¸¬è©¦ Bot é€£ç·š |

### 7.3 æŠ€è¡“å¯¦ä½œ

```javascript
// bot.js ä¸»è¦æµç¨‹

// 1. åˆå§‹åŒ– Discord Client
const client = new Client({
  intents: [GatewayIntentBits.Guilds, GatewayIntentBits.GuildMessages]
});

// 2. è¼‰å…¥æ–œç·šå‘½ä»¤
function loadCommands() {
  const commandFiles = fs.readdirSync('./commands');
  for (const file of commandFiles) {
    const command = require(`./commands/${file}`);
    client.commands.set(command.data.name, command);
  }
}

// 3. ç›£è½äº’å‹•äº‹ä»¶
client.on(Events.InteractionCreate, async interaction => {
  const command = client.commands.get(interaction.commandName);
  await command.execute(interaction);
});

// 4. Redis Pub/Sub ç›£è½ä¿¡è™Ÿè®ŠåŒ–
redisSubscriber.subscribe('signal-change', async (message) => {
  const event = JSON.parse(message);
  await handleSignalChangeNotification(event);
});
```

### 7.4 Embed è¨Šæ¯æ ¼å¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š AIFX äº¤æ˜“è¨Šè™Ÿ                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ è²¨å¹£å°ï¼šEUR/USD                         â”‚
â”‚ æ–¹å‘ï¼šğŸŸ¢ è²·å…¥ (LONG)                    â”‚
â”‚ ä¿¡å¿ƒåº¦ï¼š75%                             â”‚
â”‚ å¼·åº¦ï¼šSTRONG                            â”‚
â”‚ é€±æœŸï¼šå‘¨å…§ (1H)                         â”‚
â”‚ å¸‚å ´ç‹€æ³ï¼šTRENDING                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ’° å…¥å ´åƒ¹æ ¼: 1.08500                    â”‚
â”‚ ğŸ›‘ åœæåƒ¹æ ¼: 1.08200                    â”‚
â”‚ ğŸ¯ ç›®æ¨™åƒ¹æ ¼: 1.09000                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš ï¸ åƒ…ä¾›åƒè€ƒï¼Œè«‹è‡ªè¡Œè©•ä¼°é¢¨éšª             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 8. LINE Bot

### 8.1 åŠŸèƒ½æ¦‚è¿°

LINE Bot é€éæ–‡å­—è¨Šæ¯æŒ‡ä»¤èˆ‡ Flex Message æä¾›äº¤æ˜“è¨Šè™ŸæŸ¥è©¢èˆ‡è¨‚é–±ç®¡ç†ã€‚

### 8.2 æ–‡å­—æŒ‡ä»¤åˆ—è¡¨

| æŒ‡ä»¤ | ç¯„ä¾‹ | èªªæ˜ |
|------|------|------|
| æŸ¥è©¢è¨Šè™Ÿ | `EUR/USD` | æŸ¥è©¢é è¨­é€±æœŸè¨Šè™Ÿ |
| æŸ¥è©¢ç‰¹å®šé€±æœŸ | `EUR/USD å‘¨å…§` | æŸ¥è©¢æŒ‡å®šé€±æœŸè¨Šè™Ÿ |
| è¨‚é–± | `è¨‚é–± EUR/USD` | è¨‚é–±ä¿¡è™Ÿè®ŠåŒ–é€šçŸ¥ |
| è¨‚é–±æŒ‡å®šæ¡†æ¶ | `è¨‚é–± EUR/USD 1h` | è¨‚é–±æŒ‡å®šæ™‚é–“æ¡†æ¶ |
| å–æ¶ˆè¨‚é–± | `å–æ¶ˆè¨‚é–± EUR/USD` | å–æ¶ˆè¨‚é–± |
| æŸ¥çœ‹è¨‚é–± | `æˆ‘çš„è¨‚é–±` | æŸ¥çœ‹æ‰€æœ‰è¨‚é–± |
| å¹«åŠ© | `å¹«åŠ©` | é¡¯ç¤ºæŒ‡ä»¤èªªæ˜ |

**æ”¯æ´ä¸­è‹±æ–‡æŒ‡ä»¤ï¼š**
- ä¸­æ–‡ï¼šè¨‚é–±ã€å–æ¶ˆè¨‚é–±ã€æˆ‘çš„è¨‚é–±ã€å¹«åŠ©
- è‹±æ–‡ï¼šsubscribeã€unsubscribeã€subscriptionsã€help

### 8.3 æŠ€è¡“å¯¦ä½œ

```javascript
// bot.js ä¸»è¦æ¶æ§‹

// 1. Express Webhook ä¼ºæœå™¨
const app = express();
app.post('/webhook', line.middleware(config), async (req, res) => {
  await Promise.all(req.body.events.map(handleEvent));
  res.json({ success: true });
});

// 2. äº‹ä»¶è™•ç†
async function handleEvent(event) {
  switch (event.type) {
    case 'message':
      if (event.message.type === 'text') {
        await messageHandler.handleText(event, client);
      }
      break;
    case 'follow':
      await messageHandler.handleFollow(event, client);
      break;
    // ...
  }
}

// 3. Redis Pub/Sub ç›£è½
redisSubscriber.subscribe('signal-change', async (message) => {
  const event = JSON.parse(message);
  await handleSignalChangeNotification(event);
});
```

### 8.4 Flex Message æ ¼å¼

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“Š AIFX äº¤æ˜“è¨Šè™Ÿ                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ EUR/USD                                 â”‚
â”‚ â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚ ğŸŸ¢ è²·å…¥ (LONG)           ä¿¡å¿ƒåº¦ 75%    â”‚
â”‚                                         â”‚
â”‚ é€±æœŸï¼šå‘¨å…§ (1H)                         â”‚
â”‚ å¼·åº¦ï¼šSTRONG                            â”‚
â”‚ å¸‚å ´ï¼šTRENDING                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“ˆ æŠ€è¡“æŒ‡æ¨™                             â”‚
â”‚ SMA: 1.0850  RSI: 45                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ âš ï¸ åƒ…ä¾›åƒè€ƒï¼Œè«‹è‡ªè¡Œè©•ä¼°é¢¨éšª             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 9. è³‡æ–™åº«è¨­è¨ˆ

### 9.1 ER é—œä¿‚åœ–

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           è³‡æ–™åº«é—œè¯åœ–                                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                               â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                        â”‚
â”‚   â”‚     users       â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                                     â”‚                  â”‚
â”‚   â”‚ id (PK)         â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚                  â”‚
â”‚   â”‚ email           â”‚     â”‚ user_discord_settings â”‚       â”‚                  â”‚
â”‚   â”‚ username        â”‚     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚                  â”‚
â”‚   â”‚ password_hash   â”‚     â”‚ id (PK)               â”‚       â”‚                  â”‚
â”‚   â”‚ created_at      â”‚â—„â”€â”€â”€â”€â”‚ user_id (FK)          â”‚       â”‚                  â”‚
â”‚   â”‚ updated_at      â”‚     â”‚ discord_id            â”‚       â”‚                  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚ notification_enabled  â”‚       â”‚                  â”‚
â”‚            â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚                  â”‚
â”‚            â”‚                                               â”‚                  â”‚
â”‚            â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚                  â”‚
â”‚            â”‚              â”‚  user_line_settings   â”‚       â”‚                  â”‚
â”‚            â”‚              â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚                  â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ id (PK)               â”‚       â”‚                  â”‚
â”‚                           â”‚ user_id (FK)          â”‚       â”‚                  â”‚
â”‚                           â”‚ line_user_id          â”‚       â”‚                  â”‚
â”‚                           â”‚ display_name          â”‚       â”‚                  â”‚
â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚                  â”‚
â”‚                                                           â”‚                  â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚                  â”‚
â”‚   â”‚  market_data    â”‚     â”‚  user_subscriptions   â”‚       â”‚                  â”‚
â”‚   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤       â”‚                  â”‚
â”‚   â”‚ id (PK)         â”‚     â”‚ id (PK)               â”‚       â”‚                  â”‚
â”‚   â”‚ pair            â”‚     â”‚ user_id (FK)          â”‚â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚   â”‚ timeframe       â”‚     â”‚ pair                  â”‚                          â”‚
â”‚   â”‚ open            â”‚     â”‚ timeframe             â”‚                          â”‚
â”‚   â”‚ high            â”‚     â”‚ platform              â”‚                          â”‚
â”‚   â”‚ low             â”‚     â”‚ is_active             â”‚                          â”‚
â”‚   â”‚ close           â”‚     â”‚ created_at            â”‚                          â”‚
â”‚   â”‚ volume          â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚   â”‚ timestamp       â”‚                                                        â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚                           â”‚   trading_signals     â”‚                          â”‚
â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                          â”‚
â”‚                           â”‚ id (PK)               â”‚                          â”‚
â”‚                           â”‚ pair                  â”‚                          â”‚
â”‚                           â”‚ timeframe             â”‚                          â”‚
â”‚                           â”‚ signal                â”‚                          â”‚
â”‚                           â”‚ confidence            â”‚                          â”‚
â”‚                           â”‚ signal_strength       â”‚                          â”‚
â”‚                           â”‚ entry_price           â”‚                          â”‚
â”‚                           â”‚ stop_loss             â”‚                          â”‚
â”‚                           â”‚ take_profit           â”‚                          â”‚
â”‚                           â”‚ created_at            â”‚                          â”‚
â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                                                                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9.2 è³‡æ–™è¡¨å®šç¾©

#### users (ç”¨æˆ¶è¡¨)

```sql
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  email VARCHAR(255) UNIQUE NOT NULL,
  username VARCHAR(100) UNIQUE NOT NULL,
  password_hash VARCHAR(255) NOT NULL,
  is_active BOOLEAN DEFAULT true,
  is_verified BOOLEAN DEFAULT false,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

#### user_discord_settings (Discord ç”¨æˆ¶è¨­å®š)

```sql
CREATE TABLE user_discord_settings (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
  discord_id VARCHAR(50) UNIQUE NOT NULL,
  discord_username VARCHAR(100),
  notification_enabled BOOLEAN DEFAULT true,
  preferred_pairs TEXT[],
  risk_level INTEGER DEFAULT 5,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

#### user_line_settings (LINE ç”¨æˆ¶è¨­å®š)

```sql
CREATE TABLE user_line_settings (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
  line_user_id VARCHAR(50) UNIQUE NOT NULL,
  display_name VARCHAR(100),
  notification_enabled BOOLEAN DEFAULT true,
  preferred_pairs TEXT[],
  risk_level INTEGER DEFAULT 5,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

#### market_data (å¸‚å ´æ•¸æ“š)

```sql
CREATE TABLE market_data (
  id SERIAL PRIMARY KEY,
  pair VARCHAR(10) NOT NULL,
  timeframe VARCHAR(10) NOT NULL,
  open DECIMAL(20, 10) NOT NULL,
  high DECIMAL(20, 10) NOT NULL,
  low DECIMAL(20, 10) NOT NULL,
  close DECIMAL(20, 10) NOT NULL,
  volume DECIMAL(20, 4),
  timestamp TIMESTAMP NOT NULL,
  created_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(pair, timeframe, timestamp)
);

CREATE INDEX idx_market_data_pair_timeframe ON market_data(pair, timeframe);
CREATE INDEX idx_market_data_timestamp ON market_data(timestamp DESC);
```

#### trading_signals (äº¤æ˜“è¨Šè™Ÿ)

```sql
CREATE TABLE trading_signals (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id),
  pair VARCHAR(10) NOT NULL,
  timeframe VARCHAR(10) NOT NULL,
  signal VARCHAR(10) NOT NULL,  -- 'buy', 'sell', 'hold', 'standby'
  confidence DECIMAL(5, 4),
  signal_strength VARCHAR(20),  -- 'weak', 'moderate', 'strong', 'very_strong'
  market_condition VARCHAR(20), -- 'trending', 'ranging', 'volatile'
  entry_price DECIMAL(20, 10),
  stop_loss DECIMAL(20, 10),
  take_profit DECIMAL(20, 10),
  indicators JSONB,
  sentiment_data JSONB,
  created_at TIMESTAMP DEFAULT NOW()
);
```

#### user_subscriptions (ç”¨æˆ¶è¨‚é–±)

```sql
CREATE TABLE user_subscriptions (
  id SERIAL PRIMARY KEY,
  user_id INTEGER REFERENCES users(id) ON DELETE CASCADE,
  pair VARCHAR(10) NOT NULL,
  timeframe VARCHAR(10) NOT NULL,
  platform VARCHAR(20) NOT NULL,  -- 'discord' or 'line'
  is_active BOOLEAN DEFAULT true,
  last_notified_at TIMESTAMP,
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW(),
  UNIQUE(user_id, pair, timeframe, platform)
);
```

---

## 10. è¨‚é–±é€šçŸ¥ç³»çµ±

### 10.1 ç³»çµ±æ¶æ§‹

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         è¨‚é–±é€šçŸ¥ç³»çµ±æ¶æ§‹                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                  Signal Monitoring Service                           â”‚   â”‚
â”‚   â”‚                    (æ¯ 15 åˆ†é˜åŸ·è¡Œ)                                  â”‚   â”‚
â”‚   â”‚                                                                      â”‚   â”‚
â”‚   â”‚   1. ç²å–æ‰€æœ‰è²¨å¹£å°çš„æœ€æ–°è¨Šè™Ÿ                                        â”‚   â”‚
â”‚   â”‚   2. æ¯”å° Redis å¿«å–ä¸­çš„èˆŠè¨Šè™Ÿ                                       â”‚   â”‚
â”‚   â”‚   3. åµæ¸¬ä¿¡è™Ÿè®ŠåŒ–                                                    â”‚   â”‚
â”‚   â”‚   4. æŸ¥è©¢è©²è²¨å¹£å°çš„è¨‚é–±ç”¨æˆ¶                                          â”‚   â”‚
â”‚   â”‚   5. ç™¼å¸ƒ signal-change äº‹ä»¶                                         â”‚   â”‚
â”‚   â”‚                                                                      â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                    â”‚                                        â”‚
â”‚                                    â–¼                                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚                     Redis Pub/Sub                                   â”‚    â”‚
â”‚   â”‚                  Channel: 'signal-change'                           â”‚    â”‚
â”‚   â”‚                                                                     â”‚    â”‚
â”‚   â”‚   Event Format:                                                     â”‚    â”‚
â”‚   â”‚   {                                                                 â”‚    â”‚
â”‚   â”‚     "pair": "EUR/USD",                                             â”‚    â”‚
â”‚   â”‚     "timeframe": "1h",                                             â”‚    â”‚
â”‚   â”‚     "oldSignal": "hold",                                           â”‚    â”‚
â”‚   â”‚     "newSignal": "buy",                                            â”‚    â”‚
â”‚   â”‚     "newConfidence": 0.75,                                         â”‚    â”‚
â”‚   â”‚     "signalStrength": "strong",                                    â”‚    â”‚
â”‚   â”‚     "marketCondition": "trending",                                 â”‚    â”‚
â”‚   â”‚     "entryPrice": 1.0850,                                          â”‚    â”‚
â”‚   â”‚     "subscribers": [                                               â”‚    â”‚
â”‚   â”‚       { "platform": "discord", "id": "123456789" },               â”‚    â”‚
â”‚   â”‚       { "platform": "line", "id": "U1234567890" }                 â”‚    â”‚
â”‚   â”‚     ]                                                              â”‚    â”‚
â”‚   â”‚   }                                                                â”‚    â”‚
â”‚   â”‚                                                                     â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                    â”‚                               â”‚                        â”‚
â”‚                    â–¼                               â–¼                        â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚        Discord Bot             â”‚  â”‚         LINE Bot               â”‚   â”‚
â”‚   â”‚                                â”‚  â”‚                                â”‚   â”‚
â”‚   â”‚  â€¢ æ¥æ”¶ signal-change äº‹ä»¶     â”‚  â”‚  â€¢ æ¥æ”¶ signal-change äº‹ä»¶     â”‚   â”‚
â”‚   â”‚  â€¢ éæ¿¾ platform='discord'     â”‚  â”‚  â€¢ éæ¿¾ platform='line'        â”‚   â”‚
â”‚   â”‚  â€¢ ç™¼é€ Embed é€šçŸ¥è¨Šæ¯         â”‚  â”‚  â€¢ ç™¼é€ Flex Message           â”‚   â”‚
â”‚   â”‚                                â”‚  â”‚                                â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.2 ä¿¡è™Ÿè®ŠåŒ–åµæ¸¬é‚è¼¯

è§¸ç™¼é€šçŸ¥çš„ä¿¡è™Ÿè®ŠåŒ–ï¼š

| è®ŠåŒ–é¡å‹ | èªªæ˜ |
|----------|------|
| BUY â†” SELL | è²·å…¥èˆ‡è³£å‡ºäº’æ› |
| BUY â†” HOLD | è²·å…¥èˆ‡è§€æœ›äº’æ› |
| SELL â†” HOLD | è³£å‡ºèˆ‡è§€æœ›äº’æ› |
| ä»»ä½• â†’ STANDBY | é€²å…¥å¾…å‘½ç‹€æ…‹ |
| STANDBY â†’ ä»»ä½• | é€€å‡ºå¾…å‘½ç‹€æ…‹ |

### 10.3 å†·å»æ©Ÿåˆ¶

- åŒä¸€ç”¨æˆ¶/è²¨å¹£å°/æ™‚é–“æ¡†æ¶ï¼Œ**30 åˆ†é˜**å…§åªç™¼é€ä¸€æ¬¡é€šçŸ¥
- é˜²æ­¢éåº¦é€šçŸ¥å¹²æ“¾ç”¨æˆ¶
- å†·å»è¨˜éŒ„å­˜å„²æ–¼ Redis (TTL: 30 åˆ†é˜)

---

## 11. äº¤æ˜“é€±æœŸè¨­è¨ˆ

### 11.1 é€±æœŸå°ç…§è¡¨

| é€±æœŸ | ä¸­æ–‡ | è‹±æ–‡ | æ™‚é–“æ¡†æ¶ | é©ç”¨äº¤æ˜“è€… | æŒå€‰æ™‚é–“ |
|------|------|------|----------|-----------|----------|
| æ—¥å…§ | æ—¥å…§äº¤æ˜“ | Intraday | 15min | ç•¶æ²–å®¢ | æ•¸å°æ™‚ |
| å‘¨å…§ | æ³¢æ®µäº¤æ˜“ | Swing | 1h | æ³¢æ®µäº¤æ˜“è€… | 1-5 å¤© |
| æœˆå…§ | è¶¨å‹¢è·Ÿéš¨ | Position | 1d | ä¸­æœŸæŠ•è³‡è€… | 1-4 é€± |
| å­£å…§ | é•·æœŸæŠ•è³‡ | Long-term | 1w | é•·æœŸæŠ•è³‡è€… | 1-3 å€‹æœˆ |

### 11.2 é€±æœŸæ˜ å°„é‚è¼¯

```javascript
// backend/src/utils/periodMapper.js

const PERIOD_MAPPING = {
  // ä¸­æ–‡é€±æœŸåç¨±
  'æ—¥å…§': {
    timeframe: '15min',
    english: 'intraday',
    description: 'ç•¶å¤©å¹³å€‰',
    holdingPeriod: 'æ•¸å°æ™‚',
    technicalWeight: 0.95,
    sentimentWeight: 0.05
  },
  'å‘¨å…§': {
    timeframe: '1h',
    english: 'swing',
    description: 'æ³¢æ®µæ“ä½œ',
    holdingPeriod: '1-5å¤©',
    technicalWeight: 0.85,
    sentimentWeight: 0.15
  },
  'æœˆå…§': {
    timeframe: '1d',
    english: 'position',
    description: 'è¶¨å‹¢è·Ÿéš¨',
    holdingPeriod: '1-4é€±',
    technicalWeight: 0.55,
    sentimentWeight: 0.45
  },
  'å­£å…§': {
    timeframe: '1w',
    english: 'longterm',
    description: 'é•·æœŸæŒæœ‰',
    holdingPeriod: '1-3å€‹æœˆ',
    technicalWeight: 0.40,
    sentimentWeight: 0.60
  }
};

// è‹±æ–‡åˆ¥åæ˜ å°„
const ENGLISH_ALIASES = {
  'intraday': 'æ—¥å…§',
  'daytrading': 'æ—¥å…§',
  'swing': 'å‘¨å…§',
  'position': 'æœˆå…§',
  'longterm': 'å­£å…§',
  'long-term': 'å­£å…§'
};
```

### 11.3 API ä½¿ç”¨ç¯„ä¾‹

```bash
# ä¸­æ–‡åƒæ•¸
GET /api/v1/trading/signal?pair=EUR/USD&period=æ—¥å…§

# è‹±æ–‡åƒæ•¸
GET /api/v1/trading/signal?pair=EUR/USD&period=intraday

# ç›´æ¥ä½¿ç”¨æ™‚é–“æ¡†æ¶
GET /api/v1/trading/signal?pair=EUR/USD&timeframe=15min
```

---

## 12. API ç«¯é»å®Œæ•´åˆ—è¡¨

### 12.1 Backend API (Port 3000)

#### å…¬é–‹è·¯ç”± (ç„¡éœ€èªè­‰)

| è·¯ç”± | æ–¹æ³• | èªªæ˜ |
|------|------|------|
| `/health` | GET | å¥åº·æª¢æŸ¥ |
| `/api/v1/auth/login` | POST | ç”¨æˆ¶ç™»å…¥ |
| `/api/v1/auth/register` | POST | ç”¨æˆ¶è¨»å†Š |

#### äº¤æ˜“ API (éœ€ JWT)

| è·¯ç”± | æ–¹æ³• | èªªæ˜ |
|------|------|------|
| `/api/v1/trading/signal` | GET | æŸ¥è©¢äº¤æ˜“è¨Šè™Ÿ |
| `/api/v1/trading/signals` | GET | åˆ—å‡ºæ‰€æœ‰è¨Šè™Ÿ |

#### Discord Bot API (éœ€ X-API-Key)

| è·¯ç”± | æ–¹æ³• | èªªæ˜ |
|------|------|------|
| `/api/v1/discord/signals` | GET | ç²å–æ‰€æœ‰è¨Šè™Ÿ |
| `/api/v1/discord/signals/:pair` | GET | ç²å–ç‰¹å®šè²¨å¹£å°è¨Šè™Ÿ |
| `/api/v1/discord/users/:discordId` | GET | ç²å–ç”¨æˆ¶è³‡è¨Š |
| `/api/v1/discord/users` | POST | å»ºç«‹/æ›´æ–°ç”¨æˆ¶ |

#### LINE Bot API (éœ€ Bearer Token)

| è·¯ç”± | æ–¹æ³• | èªªæ˜ |
|------|------|------|
| `/api/v1/line/signals` | GET | ç²å–æ‰€æœ‰è¨Šè™Ÿ |
| `/api/v1/line/signals/:pair` | GET | ç²å–ç‰¹å®šè²¨å¹£å°è¨Šè™Ÿ |
| `/api/v1/line/users/:lineUserId` | GET | ç²å–ç”¨æˆ¶è³‡è¨Š |
| `/api/v1/line/users` | POST | å»ºç«‹/æ›´æ–°ç”¨æˆ¶ |
| `/api/v1/line/subscriptions` | POST | å»ºç«‹è¨‚é–± |
| `/api/v1/line/subscriptions/:lineUserId` | GET | ç²å–ç”¨æˆ¶è¨‚é–± |

#### è¨‚é–± API

| è·¯ç”± | æ–¹æ³• | èªªæ˜ |
|------|------|------|
| `/api/v1/notifications/subscribe` | POST | è¨‚é–±é€šçŸ¥ |
| `/api/v1/notifications/unsubscribe` | POST | å–æ¶ˆè¨‚é–± |
| `/api/v1/notifications/subscriptions/:userId` | GET | ç²å–è¨‚é–±åˆ—è¡¨ |

#### å¸‚å ´æ•¸æ“š API

| è·¯ç”± | æ–¹æ³• | èªªæ˜ |
|------|------|------|
| `/api/v1/market/history/:pair` | GET | ç²å–æ­·å²æ•¸æ“š |
| `/api/v1/market/data/bulk` | POST | æ‰¹é‡å¯«å…¥æ•¸æ“š (å…§éƒ¨) |

#### Admin API (éœ€ Admin JWT)

| è·¯ç”± | æ–¹æ³• | èªªæ˜ |
|------|------|------|
| `/api/v1/admin/login` | POST | ç®¡ç†å“¡ç™»å…¥ |
| `/api/v1/admin/verify` | GET | é©—è­‰ Token |
| `/api/v1/admin/health` | GET | ç³»çµ±å¥åº·ç‹€æ…‹ |
| `/api/v1/admin/stats` | GET | çµ±è¨ˆè³‡è¨Š |
| `/api/v1/admin/users` | GET | ç”¨æˆ¶åˆ—è¡¨ |
| `/api/v1/admin/signals` | GET | è¨Šè™Ÿåˆ—è¡¨ |
| `/api/v1/admin/ml/status` | GET | ML Engine ç‹€æ…‹ |
| `/api/v1/admin/sentiment/test/:pair` | GET | æ¸¬è©¦æƒ…ç·’åˆ†æ |

### 12.2 ML Engine API (Port 8000)

| è·¯ç”± | æ–¹æ³• | èªªæ˜ |
|------|------|------|
| `/health` | GET | å¥åº·æª¢æŸ¥ |
| `/predict` | POST | LSTM åƒ¹æ ¼é æ¸¬ |
| `/train` | POST | æ¨¡å‹è¨“ç·´ |
| `/model/info` | GET | æ¨¡å‹è³‡è¨Š |
| `/market-data/{pair}` | GET | ç²å–å¸‚å ´æ•¸æ“š |
| `/sentiment/analyze` | POST | æƒ…ç·’åˆ†æ |
| `/sentiment/health` | GET | æƒ…ç·’æœå‹™å¥åº·æª¢æŸ¥ |
| `/reversal/predict_raw` | POST | åè½‰é æ¸¬ |
| `/docs` | GET | Swagger API æ–‡ä»¶ |

---

## 13. èªè­‰èˆ‡å®‰å…¨æ©Ÿåˆ¶

### 13.1 èªè­‰é¡å‹å°ç…§

| èªè­‰é¡å‹ | Header | æ ¼å¼ | ä½¿ç”¨è€… | èªªæ˜ |
|----------|--------|------|--------|------|
| API Key | X-API-Key | 64 å­—å…ƒ hex | Discord Bot | æœå‹™é–“èªè­‰ |
| Bearer Token | Authorization | Bearer + 64 å­—å…ƒ | LINE Bot | æœå‹™é–“èªè­‰ |
| JWT Token | Authorization | Bearer + JWT | å‰ç«¯ç”¨æˆ¶ | ç”¨æˆ¶èªè­‰ |
| Admin Token | Authorization | Bearer + JWT | ç®¡ç†å“¡ | ç®¡ç†å¾Œå°èªè­‰ |

### 13.2 èªè­‰ä¸­é–“ä»¶é‚è¼¯

```javascript
// middleware/auth.js

async function authenticate(req, res, next) {
  const authHeader = req.headers.authorization;
  const apiKey = req.headers['x-api-key'];

  // 1. æª¢æŸ¥ X-API-Key (Discord Bot)
  if (apiKey) {
    if (apiKey === process.env.API_KEY) {
      req.user = { type: 'discord-bot' };
      return next();
    }
    return res.status(401).json({ error: 'Invalid API Key' });
  }

  // 2. æª¢æŸ¥ Bearer Token
  if (authHeader && authHeader.startsWith('Bearer ')) {
    const token = authHeader.substring(7);

    // 2a. 64 å­—å…ƒ hex (LINE Bot API Key)
    if (token.length === 64 && !token.includes('.')) {
      if (token === process.env.LINE_BOT_API_KEY) {
        req.user = { type: 'line-bot' };
        return next();
      }
      return res.status(401).json({ error: 'Invalid API Key' });
    }

    // 2b. JWT Token (ç”¨æˆ¶/ç®¡ç†å“¡)
    try {
      const decoded = jwt.verify(token, process.env.JWT_SECRET);
      req.user = decoded;
      return next();
    } catch (err) {
      return res.status(401).json({ error: 'Invalid token' });
    }
  }

  return res.status(401).json({ error: 'Authentication required' });
}
```

### 13.3 å®‰å…¨æœ€ä½³å¯¦è¸

| é …ç›® | å¯¦ä½œæ–¹å¼ |
|------|----------|
| å¯†ç¢¼é›œæ¹Š | bcrypt (10 rounds) |
| JWT éæœŸ | Access: 15åˆ†é˜, Refresh: 7å¤© |
| API é€Ÿç‡é™åˆ¶ | 100 req/min/IP |
| CORS | é™åˆ¶å…è¨±çš„ä¾†æº |
| å®‰å…¨æ¨™é ­ | helmet middleware |
| SQL æ³¨å…¥é˜²è­· | Sequelize åƒæ•¸åŒ–æŸ¥è©¢ |
| XSS é˜²è­· | è¼¸å…¥é©—è­‰èˆ‡è½‰ç¾© |

---

## 14. æ•¸æ“šæµç¨‹åœ–

### 14.1 äº¤æ˜“è¨Šè™Ÿç”Ÿæˆæµç¨‹

```
ç”¨æˆ¶è«‹æ±‚è¨Šè™Ÿ
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Backend API                                      â”‚
â”‚                                                                         â”‚
â”‚   1. é©—è­‰è«‹æ±‚åƒæ•¸ (pair, timeframe)                                     â”‚
â”‚   2. æŸ¥è©¢ Redis å¿«å–                                                    â”‚
â”‚      â”œâ”€ å‘½ä¸­: è¿”å›å¿«å–çµæœ                                              â”‚
â”‚      â””â”€ æœªå‘½ä¸­: ç¹¼çºŒè™•ç†                                                â”‚
â”‚                                                                         â”‚
â”‚   3. ç²å–å¸‚å ´æ•¸æ“š (æ··åˆæ¨¡å¼)                                            â”‚
â”‚      â”œâ”€ å¾ PostgreSQL è®€å– 99 æ ¹æ­·å² K ç·š                               â”‚
â”‚      â””â”€ å¾ Twelve Data API ç²å– 1 æ ¹æœ€æ–° K ç·š                           â”‚
â”‚         (è‹¥å¤±æ•— â†’ è‡ªå‹•åˆ‡æ› yfinance å‚™ç”¨ä¾†æº)                           â”‚
â”‚                                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        ML Engine                                         â”‚
â”‚                                                                          â”‚
â”‚   4. æ•¸æ“šé è™•ç†                                                          â”‚
â”‚      â”œâ”€ è¨ˆç®—æŠ€è¡“æŒ‡æ¨™ (SMA, EMA, RSI, MACD, Bollinger)                   â”‚
â”‚      â””â”€ æ­£è¦åŒ–æ•¸æ“š (MinMaxScaler)                                        â”‚
â”‚                                                                          â”‚
â”‚   5. LSTM é æ¸¬                                                           â”‚
â”‚      â”œâ”€ è¼¸å…¥: 60 æ™‚é–“æ­¥ Ã— 12 ç‰¹å¾µ                                        â”‚
â”‚      â””â”€ è¼¸å‡º: [Long, Short, Standby] æ©Ÿç‡                                â”‚
â”‚                                                                          â”‚
â”‚   6. æƒ…ç·’åˆ†æ (æ··åˆä¾†æº)                                                 â”‚
â”‚      â”œâ”€ æŠ“å–ç›¸é—œæ–°è (NewsAPI ä¸»è¦ â†’ Google News RSS å‚™ç”¨)               â”‚
â”‚      â”œâ”€ FinBERT åˆ†ææ–°èæƒ…ç·’                                             â”‚
â”‚      â””â”€ VADER åˆ†æå¤®è¡Œæ”¿ç­–                                               â”‚
â”‚                                                                          â”‚
â”‚   7. è¨Šè™Ÿèåˆ                                                            â”‚
â”‚      â”œâ”€ è¨ˆç®—æ™‚é–“æ¡†æ¶æ¬Šé‡                                                 â”‚
â”‚      â”œâ”€ technical_score Ã— tech_weight + sentiment_score Ã— sent_weight   â”‚
â”‚      â””â”€ åˆ¤å®šè¨Šè™Ÿå¼·åº¦ (weak/moderate/strong/very_strong)                  â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Backend API                                       â”‚
â”‚                                                                          â”‚
â”‚   8. çµ„è£å›æ‡‰                                                            â”‚
â”‚      {                                                                   â”‚
â”‚        "signal": "buy",                                                  â”‚
â”‚        "confidence": 0.75,                                               â”‚
â”‚        "signalStrength": "strong",                                       â”‚
â”‚        "marketCondition": "trending",                                    â”‚
â”‚        "entryPrice": 1.0850,                                             â”‚
â”‚        "stopLoss": 1.0820,                                               â”‚
â”‚        "takeProfit": 1.0900,                                             â”‚
â”‚        "indicators": { ... },                                            â”‚
â”‚        "sentiment": { ... }                                              â”‚
â”‚      }                                                                   â”‚
â”‚                                                                          â”‚
â”‚   9. å¿«å–çµæœ (Redis, TTL: 60 ç§’)                                        â”‚
â”‚   10. è¿”å›å›æ‡‰çµ¦ç”¨æˆ¶                                                     â”‚
â”‚                                                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 14.2 è¨‚é–±é€šçŸ¥æµç¨‹

```
ç”¨æˆ¶è¨‚é–± EUR/USD
     â”‚
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Bot (Discord/LINE)                                                     â”‚
â”‚   1. è§£æç”¨æˆ¶æŒ‡ä»¤                                                        â”‚
â”‚   2. å‘¼å« Backend API: POST /api/v1/notifications/subscribe             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Backend API                                                            â”‚
â”‚   3. é©—è­‰ç”¨æˆ¶å­˜åœ¨ (è‹¥ä¸å­˜åœ¨å‰‡å»ºç«‹)                                       â”‚
â”‚   4. å»ºç«‹è¨‚é–±è¨˜éŒ„ (user_subscriptions è¡¨)                                â”‚
â”‚   5. è¿”å›æˆåŠŸå›æ‡‰                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Bot (Discord/LINE)                                                     â”‚
â”‚   6. ç™¼é€ç¢ºèªè¨Šæ¯çµ¦ç”¨æˆ¶                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

... æ™‚é–“ç¶“é ...

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Signal Monitoring Service (æ¯ 15 åˆ†é˜)                                 â”‚
â”‚   7. ç²å–æ‰€æœ‰è²¨å¹£å°æœ€æ–°è¨Šè™Ÿ                                              â”‚
â”‚   8. æ¯”å° Redis ä¸­çš„èˆŠè¨Šè™Ÿ                                               â”‚
â”‚   9. åµæ¸¬åˆ° EUR/USD ä¿¡è™Ÿè®ŠåŒ–: HOLD â†’ BUY                                 â”‚
â”‚   10. æŸ¥è©¢è¨‚é–± EUR/USD çš„ç”¨æˆ¶                                            â”‚
â”‚   11. ç™¼å¸ƒ Redis Pub/Sub äº‹ä»¶åˆ° 'signal-change' é »é“                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â–¼                               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Discord Bot           â”‚   â”‚   LINE Bot                               â”‚
â”‚   12. æ¥æ”¶äº‹ä»¶          â”‚   â”‚   12. æ¥æ”¶äº‹ä»¶                           â”‚
â”‚   13. éæ¿¾ discord è¨‚é–±  â”‚   â”‚   13. éæ¿¾ line è¨‚é–±                     â”‚
â”‚   14. ç™¼é€ Embed é€šçŸ¥    â”‚   â”‚   14. ç™¼é€ Push Message é€šçŸ¥             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 15. éƒ¨ç½²æŒ‡å—

### 15.1 å‰ç½®éœ€æ±‚

| è»Ÿé«” | æœ€ä½ç‰ˆæœ¬ | èªªæ˜ |
|------|----------|------|
| Node.js | 18.0.0 | JavaScript åŸ·è¡Œç’°å¢ƒ |
| Python | 3.9 | ML Engine |
| PostgreSQL | 14.0 | ä¸»è³‡æ–™åº« |
| Redis | 6.0 | å¿«å–/Pub/Sub |
| PM2 | latest | Node.js ç¨‹åºç®¡ç† |

### 15.2 å®‰è£æ­¥é©Ÿ

```bash
# 1. å…‹éš†å°ˆæ¡ˆ
git clone https://github.com/LazOof69/AIFX_v2.git
cd AIFX_v2

# 2. å®‰è£ Backend ä¾è³´
cd backend && npm install

# 3. å®‰è£ ML Engine ä¾è³´
cd ../ml_engine
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# 4. å®‰è£ Discord Bot ä¾è³´
cd ../discord_bot && npm install

# 5. å®‰è£ LINE Bot ä¾è³´
cd ../line_bot && npm install

# 6. è¨­ç½®ç’°å¢ƒè®Šæ•¸
cd ..
cp backend/.env.example backend/.env
# ç·¨è¼¯ backend/.env é…ç½®å¿…è¦çš„ç’°å¢ƒè®Šæ•¸

# 7. è³‡æ–™åº«é·ç§»
cd backend
npx sequelize-cli db:migrate

# 8. å•Ÿå‹•æ‰€æœ‰æœå‹™
cd ..
./start-all-services.sh
```

### 15.3 PM2 é…ç½®ç¯„ä¾‹

```javascript
// ecosystem.config.js
module.exports = {
  apps: [
    {
      name: 'aifx-backend',
      script: 'backend/src/server.js',
      instances: 1,
      autorestart: true,
      watch: false,
      max_memory_restart: '1G',
      env: {
        NODE_ENV: 'production',
        PORT: 3000
      }
    },
    {
      name: 'aifx-discord-bot',
      script: 'discord_bot/bot.js',
      instances: 1,
      autorestart: true,
      watch: false
    },
    {
      name: 'aifx-line-bot',
      script: 'line_bot/bot.js',
      instances: 1,
      autorestart: true,
      watch: false,
      env: {
        PORT: 3001
      }
    }
  ]
};
```

### 15.4 ç³»çµ±æœå‹™ (systemd)

```ini
# /etc/systemd/system/aifx-ml-engine.service
[Unit]
Description=AIFX ML Engine
After=network.target

[Service]
Type=simple
User=root
WorkingDirectory=/root/AIFX_v2/ml_engine
ExecStart=/root/AIFX_v2/ml_engine/venv/bin/python api/ml_server.py
Restart=always
RestartSec=10

[Install]
WantedBy=multi-user.target
```

---

## 16. ç’°å¢ƒè®Šæ•¸å®Œæ•´åˆ—è¡¨

### 16.1 Backend (.env)

```env
# æœå‹™é…ç½®
NODE_ENV=development
PORT=3000

# è³‡æ–™åº«
DATABASE_URL=postgresql://user:password@localhost:5432/aifx_db

# Redis
REDIS_URL=redis://localhost:6379
REDIS_DB=2

# JWT èªè­‰
JWT_SECRET=your-jwt-secret-key-min-32-chars
JWT_REFRESH_SECRET=your-jwt-refresh-secret-key
JWT_EXPIRES_IN=15m
JWT_REFRESH_EXPIRES_IN=7d

# å¤–éƒ¨ API
TWELVE_DATA_KEY=your-twelve-data-api-key

# ML Engine
ML_API_URL=http://localhost:8000

# Discord Bot
DISCORD_BOT_TOKEN=your-discord-bot-token
DISCORD_CLIENT_ID=your-discord-client-id
DISCORD_SIGNAL_CHANNEL_ID=your-signal-channel-id

# LINE Bot
LINE_CHANNEL_ACCESS_TOKEN=your-line-channel-access-token
LINE_CHANNEL_SECRET=your-line-channel-secret

# æœå‹™é–“èªè­‰ (64 å­—å…ƒåå…­é€²ä½)
API_KEY=your-discord-api-key-64-hex-chars
LINE_BOT_API_KEY=your-line-api-key-64-hex-chars

# Admin ç®¡ç†å¾Œå°
ADMIN_USERNAME=admin
ADMIN_PASSWORD=your-admin-password
ADMIN_JWT_SECRET=your-admin-jwt-secret

# æ—¥èªŒ
LOG_LEVEL=info
LOG_FILE=/root/AIFX_v2/logs/backend.log
```

### 16.2 ML Engine (.env)

```env
# ML Engine
ML_ENGINE_PORT=8000

# Twelve Data API
TWELVE_DATA_KEY=your-api-key

# Backend API (ç”¨æ–¼æ•¸æ“šå­˜å–)
BACKEND_API_URL=http://localhost:3000
ML_ENGINE_API_KEY=your-api-key

# æƒ…ç·’åˆ†æ
NEWS_API_KEY=your-newsapi-key

# æ¨¡å‹é…ç½®
MODEL_PATH=./saved_models
SENTIMENT_MODEL=ProsusAI/finbert
```

### 16.3 Discord Bot (.env)

```env
DISCORD_BOT_TOKEN=your-bot-token
DISCORD_CLIENT_ID=your-client-id
DISCORD_SIGNAL_CHANNEL_ID=your-channel-id
BACKEND_API_URL=http://localhost:3000
API_KEY=your-64-char-api-key
REDIS_URL=redis://localhost:6379
REDIS_DB=2
```

### 16.4 LINE Bot (.env)

```env
LINE_CHANNEL_ACCESS_TOKEN=your-channel-token
LINE_CHANNEL_SECRET=your-channel-secret
BACKEND_API_URL=http://localhost:3000
LINE_BOT_API_KEY=your-64-char-api-key
REDIS_URL=redis://localhost:6379
REDIS_DB=2
PORT=3001
```

---

## 17. é–‹ç™¼æ­·ç¨‹

### 17.1 ä¸»è¦é‡Œç¨‹ç¢‘

| æ—¥æœŸ | åŠŸèƒ½ | èªªæ˜ |
|------|------|------|
| 2025-11-26 | äº¤æ˜“é€±æœŸåŠŸèƒ½ | å¯¦ä½œæ—¥å…§/å‘¨å…§/æœˆå…§/å­£å…§å››ç¨®é€±æœŸ |
| 2025-11-27 | è¨‚é–±é€šçŸ¥ MVP | Redis Pub/Sub + Discord é€šçŸ¥ |
| 2025-11-28 | è¨‚é–±é€šçŸ¥å¢å¼· | Embed æ ¼å¼ + å†·å»æ©Ÿåˆ¶ |
| 2025-11-28 | LINE Bot æ•´åˆ | å®Œæ•´ LINE Bot åŠŸèƒ½ |
| 2025-11-29 | æ•¸æ“šæ”¶é›†ç³»çµ± | æ··åˆæ¨¡å¼ + Cron æ’ç¨‹ |
| 2025-12-02 | æ–‡ä»¶æ•´åˆ | æ•´åˆæ‰€æœ‰é–‹ç™¼æ–‡ä»¶ |

### 17.2 é‡è¦ Bug ä¿®å¾©

| å•é¡Œ | æª”æ¡ˆ | ä¿®å¾©æ–¹å¼ |
|------|------|----------|
| å¿«å–é›™é‡è§£æ | forexService.js:53 | ç§»é™¤å¤šé¤˜çš„ JSON.parse() |
| Discord äº’å‹•è¶…æ™‚ | discord_bot/bot.js | å¯¦ä½œ deferWithRetry() é‡è©¦æ©Ÿåˆ¶ |
| LINE ç”¨æˆ¶è¨»å†Šå¤±æ•— | usersController.js | ä¿®æ­£ API Key èªè­‰é‚è¼¯ |

---

## 18. å¸¸è¦‹å•é¡Œ

### 18.1 é€£ç·šå•é¡Œ

**Q: Backend é€£ä¸ä¸Šè³‡æ–™åº«ï¼Ÿ**
```bash
# æª¢æŸ¥ PostgreSQL æœå‹™
sudo systemctl status postgresql

# æª¢æŸ¥é€£ç·šå­—ä¸²æ ¼å¼
DATABASE_URL=postgresql://user:password@localhost:5432/aifx_db
```

**Q: Redis é€£ç·šå¤±æ•—ï¼Ÿ**
```bash
# æª¢æŸ¥ Redis æœå‹™
redis-cli ping
# æ‡‰è©²å›æ‡‰ PONG
```

**Q: ML Engine é€£ç·šå¤±æ•—ï¼Ÿ**
```bash
# æª¢æŸ¥ ML Engine æ˜¯å¦é‹è¡Œ
curl http://localhost:8000/health
```

### 18.2 Bot å•é¡Œ

**Q: Discord Bot æŒ‡ä»¤æ²’æœ‰å‡ºç¾ï¼Ÿ**
```bash
# é‡æ–°éƒ¨ç½²æ–œç·šå‘½ä»¤
cd discord_bot
node deploy-commands.js
```

**Q: LINE Bot æ”¶ä¸åˆ°è¨Šæ¯ï¼Ÿ**
1. ç¢ºèª Webhook URL è¨­å®šæ­£ç¢º
2. ç¢ºèª Channel Access Token æœ‰æ•ˆ
3. æª¢æŸ¥ PORT=3001 æ˜¯å¦è¢«ä½”ç”¨

**Q: è¨‚é–±å¾Œæ”¶ä¸åˆ°é€šçŸ¥ï¼Ÿ**
1. ç¢ºèª Redis æœå‹™é‹è¡Œä¸­
2. ç¢ºèª Backend ä¿¡è™Ÿç›£æ§æœå‹™é‹è¡Œä¸­
3. æª¢æŸ¥è¨‚é–±æ˜¯å¦æˆåŠŸå»ºç«‹

### 18.3 ML Engine å•é¡Œ

**Q: æ¨¡å‹è¼‰å…¥å¤±æ•—ï¼Ÿ**
```bash
# ç¢ºèªæ¨¡å‹æª”æ¡ˆå­˜åœ¨
ls ml_engine/saved_models/
```

**Q: æƒ…ç·’åˆ†æå›æ‡‰æ…¢ï¼Ÿ**
- é¦–æ¬¡è¼‰å…¥ FinBERT æ¨¡å‹éœ€è¦ä¸‹è¼‰ç´„ 400MB
- å»ºè­°é å…ˆå•Ÿå‹•æœå‹™è®“æ¨¡å‹è¼‰å…¥å®Œæˆ

**Q: API é…é¡ä¸è¶³ï¼Ÿ**
- å•Ÿç”¨æ··åˆæ¨¡å¼å¾è³‡æ–™åº«è®€å–æ­·å²æ•¸æ“š
- æª¢æŸ¥ Cron æ’ç¨‹æ˜¯å¦æ­£ç¢º

---

## å…è²¬è²æ˜

1. æœ¬ç³»çµ±æä¾›çš„äº¤æ˜“è¨Šè™Ÿ**åƒ…ä¾›åƒè€ƒ**ï¼Œä¸æ§‹æˆæŠ•è³‡å»ºè­°
2. å¤–åŒ¯äº¤æ˜“æ¶‰åŠé«˜é¢¨éšªï¼Œå¯èƒ½å°è‡´è³‡é‡‘æå¤±
3. éå»è¡¨ç¾ä¸ä¿è­‰æœªä¾†çµæœ
4. ç”¨æˆ¶æ‡‰è‡ªè¡Œè©•ä¼°é¢¨éšªä¸¦åšå‡ºäº¤æ˜“æ±ºç­–

---

## æˆæ¬Š

MIT License

---

<div align="center">

**AIFX v2** - *Empowering Traders with AI*

[GitHub](https://github.com/LazOof69/AIFX_v2) â€¢ [å›å ±å•é¡Œ](https://github.com/LazOof69/AIFX_v2/issues)

**æœ€å¾Œæ›´æ–°**: 2025-12-03

</div>
